@using Microsoft.AspNetCore.Http
@using Project_D.Shared;
@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor
@{string sessionCode = HttpContextAccessor.HttpContext.Session.GetString("SessionCode");}
<!DOCTYPE html>
<html lang="en">
<head>
    <title>Microsoft Teams Hello World Sample App</title>
    <base href="@(Url.Content("~"))" />
    <link href="/Content/msteams-16.css" rel="stylesheet" />
    <link href="/Content/Site.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0" crossorigin="anonymous">

    @RenderSection("scripts", required: false)
</head>

<body class="theme-light">

    <div class="surface">
        <div class="panel">

            <!-- copy to clipboard function -->
            <script>function copyCode() {
                    const str = "@HttpContextAccessor.HttpContext.Session.GetString("SessionCode")"
                    const el = document.createElement('textarea')
                    el.value = str
                    el.setAttribute('readonly', '')
                    el.style.position = 'absolute'
                    el.style.left = '-9999px'
                    document.body.appendChild(el)
                    el.select()
                    document.execCommand('copy')
                    document.body.removeChild(el)
                }</script>

            <nav class="navbar sticky-top navbar-light bg-light">
                <div class="container-fluid" id="sessioncode" href="#" onclick="copyCode()">
                    <span class="navbar-text" style= "font-size: calc(6em - 3.5vw);line-height:normal">
                        Session code:
                        <a href="#" onclick="copyCode()">@HttpContextAccessor.HttpContext.Session.GetString("SessionCode")</a>
                        People online: @Shared.GetPeopleInSession(sessionCode).ToString()
                        (Debug only: <a> User code: @HttpContextAccessor.HttpContext.Session.GetString("UserCode"), Whiteboardcode: @HttpContextAccessor.HttpContext.Session.GetString("WhiteboardSessionCode")</a>)
                    </span>
                    <form class="d-flex">
                        <button class="btn btn-outline-info" onclick="copyCode()">Copy Session Code</button>
                    </form>
                </div>

            </nav>


            @RenderBody()
        </div>
    </div>
    <script type="text/javascript" src="https://statics.teams.cdn.office.net/sdk/v1.5.2/js/MicrosoftTeams.min.js"></script>
    <script type="text/javascript" src="/Scripts/teamsapp.js"></script>
</body>
</html>
