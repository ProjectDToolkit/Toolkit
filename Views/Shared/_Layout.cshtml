@using Microsoft.AspNetCore.Http
@using Project_D.Shared;
@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor

<!DOCTYPE html>
<html lang="en">
<head>
    <title>Microsoft Teams Hello World Sample App</title>
    <base href="@(Url.Content("~"))" />
    <link href="/Content/msteams-16.css" rel="stylesheet" />
    <link href="/Content/Site.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0" crossorigin="anonymous">

    @RenderSection("scripts", required: false)
</head>

<body class="theme-light">

    <div class="surface">
        <div class="panel">

            <!-- copy to clipboard function -->
            <script>function copyCode() {
                    const str = document.getElementById('myInput').innerText
                    const el = document.createElement('textarea')
                    el.value = str
                    el.setAttribute('readonly', '')
                    el.style.position = 'absolute'
                    el.style.left = '-9999px'
                    document.body.appendChild(el)
                    el.select()
                    document.execCommand('copy')
                    document.body.removeChild(el)
                }</script>

            <nav class="navbar sticky-top navbar-light bg-light">
                <a class="navbar-brand" id="sessioncode" href="#" onclick="copyCode()">
                    @{string sessionCode = HttpContextAccessor.HttpContext.Session.GetString("SessionCode");}
                    Session code: @HttpContextAccessor.HttpContext.Session.GetString("SessionCode"), User code: @HttpContextAccessor.HttpContext.Session.GetString("UserCode"), People online: @Shared.GetPeopleInSession(sessionCode).ToString()
                </a>
                <div hidden="hidden" id="myInput">@ViewBag.SessionCode</div>
                <button class="btn btn-info btn-sm" onclick="copyCode()">Copy Session Code</button>
            </nav>


            @RenderBody()
        </div>
    </div>
    <script type="text/javascript" src="https://statics.teams.cdn.office.net/sdk/v1.5.2/js/MicrosoftTeams.min.js"></script>
    <script type="text/javascript" src="/Scripts/teamsapp.js"></script>
</body>
</html>
